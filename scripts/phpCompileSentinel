echo Running phpSentinelCompileSentinel

# script that is called by root with user sentinel
# path and env are not set correctly though

HOME="/home/sentinel"
LANG=en_US.UTF-8
PATH=/home/sentinel/git/sentinel/scripts:/home/sentinel/.cabal/bin/:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games

export HOME
export LANG
export PATH

cd /home/sentinel/git/sentinel
echo Sentinel is on branch `git rev-parse --abbrev-ref HEAD`
echo Fetching and pulling latest commit
git fetch
git pull

echo "Cleaning Sentinel and installing sandbox (if not already installed)"

cabal clean 
rm -rf .cabal-sandbox
cabal sandbox init

echo Running cabal update and cabal install on sentinel
cabal update
cabal install --bindir=/home/sentinel/.cabal/bin/
